{
  "openapi": "3.0.0",
  "paths": {
    "/health": {
      "get": {
        "description": "Returns \"ok\" if the service is running",
        "operationId": "AppController_getHealth",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Service is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        },
        "summary": "Health check endpoint",
        "tags": [
          "Health"
        ]
      }
    },
    "/api/v1/oer": {
      "get": {
        "description": "Search and filter OER aggregated from Nostr relays. Supports pagination and various filters including type, searchTerm, license, educational level, and language. Rate limited to 10 requests per 60 seconds per IP.",
        "operationId": "OerController_getOer",
        "parameters": [
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "Page number (min: 1, default: 1)",
            "schema": {
              "example": 1,
              "type": "number"
            }
          },
          {
            "name": "pageSize",
            "required": false,
            "in": "query",
            "description": "Items per page (min: 1, max: 20, default: 20)",
            "schema": {
              "example": 20,
              "type": "number"
            }
          },
          {
            "name": "source",
            "required": false,
            "in": "query",
            "description": "Data source to query. Default (or \"nostr\"): Nostr database only. Use adapter ID (e.g., \"arasaac\") to query external sources.",
            "schema": {
              "example": "nostr",
              "type": "string"
            }
          },
          {
            "name": "type",
            "required": false,
            "in": "query",
            "description": "Filter by MIME type or AMB metadata type (partial match)",
            "schema": {
              "example": "image",
              "type": "string"
            }
          },
          {
            "name": "searchTerm",
            "required": false,
            "in": "query",
            "description": "Search term (searches in name, description, and keywords array)",
            "schema": {
              "example": "plants",
              "type": "string"
            }
          },
          {
            "name": "license",
            "required": false,
            "in": "query",
            "description": "Filter by license URI (exact match)",
            "schema": {
              "example": "https://creativecommons.org/licenses/by/4.0/",
              "type": "string"
            }
          },
          {
            "name": "free_for_use",
            "required": false,
            "in": "query",
            "description": "Filter by free for use status (true or false)",
            "schema": {
              "example": true,
              "type": "boolean"
            }
          },
          {
            "name": "educational_level",
            "required": false,
            "in": "query",
            "description": "Filter by educational level URI (exact match)",
            "schema": {
              "example": "https://w3id.org/kim/educationalLevel/level_06",
              "type": "string"
            }
          },
          {
            "name": "language",
            "required": false,
            "in": "query",
            "description": "Filter by language code (2-3 lowercase letters, e.g., \"en\", \"fr\")",
            "schema": {
              "example": "en",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved OER list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OerListResponseSchema"
                }
              }
            }
          },
          "400": {
            "description": "Invalid query parameters",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "statusCode": {
                      "type": "number",
                      "example": 400
                    },
                    "message": {
                      "oneOf": [
                        {
                          "type": "string",
                          "example": "Invalid query parameters"
                        },
                        {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "example": [
                            "page must be at least 1",
                            "pageSize must be at most 20"
                          ]
                        }
                      ]
                    },
                    "error": {
                      "type": "string",
                      "example": "Bad Request"
                    }
                  }
                }
              }
            }
          },
          "429": {
            "description": "Rate limit exceeded (10 requests per 60 seconds per IP)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "statusCode": {
                      "type": "number",
                      "example": 429
                    },
                    "message": {
                      "type": "string",
                      "example": "ThrottlerException: Too Many Requests"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "summary": "Query Open Educational Resources",
        "tags": [
          "OER"
        ]
      }
    }
  },
  "info": {
    "title": "OER Aggregator API",
    "description": "API for querying Open Educational Resources (OER) aggregated from Nostr relays",
    "version": "1.0",
    "contact": {}
  },
  "tags": [
    {
      "name": "OER",
      "description": "Open Educational Resources query endpoints"
    },
    {
      "name": "Health",
      "description": "Health check endpoints"
    }
  ],
  "servers": [],
  "components": {
    "schemas": {
      "AmbMetadataSchema": {
        "type": "object",
        "properties": {
          "@context": {
            "type": "object",
            "description": "JSON-LD context URI(s)",
            "example": [
              "https://w3id.org/kim/amb/context.jsonld"
            ]
          },
          "id": {
            "type": "string",
            "description": "Unique identifier (URI) of the resource",
            "example": "https://example.org/resource/123"
          },
          "type": {
            "type": "object",
            "description": "Type of the educational resource (e.g., LearningResource, CreativeWork)",
            "example": "LearningResource"
          },
          "name": {
            "type": "string",
            "description": "Name/title of the educational resource",
            "example": "Introduction to Biology"
          },
          "description": {
            "type": "string",
            "description": "Textual description of the resource content",
            "example": "A comprehensive guide to basic biology concepts for students"
          },
          "about": {
            "type": "object",
            "description": "Subject matter or topics covered (references to controlled vocabularies)",
            "example": [
              {
                "id": "http://w3id.org/kim/hochschulfaechersystematik/n079"
              }
            ]
          },
          "keywords": {
            "description": "Keywords/tags describing the resource",
            "example": [
              "biology",
              "science",
              "education"
            ],
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "inLanguage": {
            "description": "Language code(s) following BCP47 standard",
            "example": [
              "en",
              "de"
            ],
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "image": {
            "type": "string",
            "description": "URL of a thumbnail or preview image",
            "example": "https://example.org/images/resource-thumbnail.jpg"
          },
          "trailer": {
            "type": "object",
            "description": "Video or audio preview with contentUrl or embedUrl",
            "example": {
              "type": "VideoObject",
              "contentUrl": "https://example.org/videos/preview.mp4"
            }
          },
          "creator": {
            "type": "object",
            "description": "Creator(s) of the resource (Person or Organization with name, type, and optional identifiers)",
            "example": [
              {
                "type": "Person",
                "name": "Jane Doe"
              }
            ]
          },
          "contributor": {
            "type": "object",
            "description": "Additional contributor(s) to the resource",
            "example": [
              {
                "type": "Person",
                "name": "John Smith"
              }
            ]
          },
          "affiliation": {
            "type": "object",
            "description": "Organizational affiliation of the creator",
            "example": {
              "type": "Organization",
              "name": "University of Example"
            }
          },
          "dateCreated": {
            "type": "string",
            "description": "Date the resource was created (ISO 8601 format)",
            "example": "2024-01-15"
          },
          "datePublished": {
            "type": "string",
            "description": "Date the resource was published (ISO 8601 format)",
            "example": "2024-02-01"
          },
          "dateModified": {
            "type": "string",
            "description": "Date the resource was last modified (ISO 8601 format)",
            "example": "2024-03-10"
          },
          "publisher": {
            "type": "object",
            "description": "Publisher(s) of the resource",
            "example": [
              {
                "type": "Organization",
                "name": "Educational Press"
              }
            ]
          },
          "funder": {
            "type": "object",
            "description": "Funding source(s) or program(s)",
            "example": [
              {
                "type": "Organization",
                "name": "Research Foundation"
              }
            ]
          },
          "isAccessibleForFree": {
            "type": "boolean",
            "description": "Whether the resource is free to access",
            "example": true
          },
          "license": {
            "type": "object",
            "description": "License information (Creative Commons or other open license)",
            "example": {
              "id": "https://creativecommons.org/licenses/by/4.0/"
            }
          },
          "conditionsOfAccess": {
            "type": "object",
            "description": "Access requirements or restrictions",
            "example": {
              "type": "ConditionsOfAccess",
              "name": "Registration required"
            }
          },
          "learningResourceType": {
            "type": "object",
            "description": "Type of learning resource (references to HCRT/OEHRT vocabularies)",
            "example": [
              {
                "id": "https://w3id.org/kim/hcrt/worksheet"
              }
            ]
          },
          "audience": {
            "type": "object",
            "description": "Target audience role(s) per LRMI",
            "example": [
              {
                "id": "http://purl.org/dcx/lrmi-vocabs/educationalAudienceRole/student"
              }
            ]
          },
          "teaches": {
            "type": "object",
            "description": "Competencies that learners can achieve",
            "example": [
              {
                "type": "DefinedTerm",
                "name": "Understanding cell division"
              }
            ]
          },
          "assesses": {
            "type": "object",
            "description": "Competencies that can be assessed/evaluated",
            "example": [
              {
                "type": "DefinedTerm",
                "name": "Knowledge of photosynthesis"
              }
            ]
          },
          "competencyRequired": {
            "type": "object",
            "description": "Prerequisites for understanding the resource",
            "example": [
              {
                "type": "DefinedTerm",
                "name": "Basic chemistry knowledge"
              }
            ]
          },
          "educationalLevel": {
            "type": "object",
            "description": "Educational level or stage (references to educational level vocabularies)",
            "example": [
              {
                "id": "https://w3id.org/kim/educationalLevel/level_06"
              }
            ]
          },
          "interactivityType": {
            "type": "object",
            "description": "Learning method (expositive/active/mixed)",
            "example": {
              "id": "http://w3id.org/kim/interactivitytype/mixed"
            }
          },
          "isBasedOn": {
            "type": "object",
            "description": "Source resource for derivative works",
            "example": [
              {
                "id": "https://example.org/original-resource"
              }
            ]
          },
          "isPartOf": {
            "type": "object",
            "description": "Parent resource(s) or collection(s)",
            "example": [
              {
                "id": "https://example.org/course/biology-101"
              }
            ]
          },
          "hasPart": {
            "type": "object",
            "description": "Child or component resource(s)",
            "example": [
              {
                "id": "https://example.org/lesson/cell-structure"
              }
            ]
          },
          "mainEntityOfPage": {
            "type": "object",
            "description": "Metadata provider and creation information",
            "example": [
              {
                "type": "WebPage",
                "dateCreated": "2024-01-15",
                "provider": {
                  "type": "Organization",
                  "name": "Metadata Service"
                }
              }
            ]
          },
          "duration": {
            "type": "string",
            "description": "Playback duration (ISO 8601 format)",
            "example": "PT1H30M"
          },
          "encoding": {
            "type": "object",
            "description": "Download options with MediaObject details",
            "example": [
              {
                "type": "MediaObject",
                "contentUrl": "https://example.org/downloads/resource.pdf",
                "encodingFormat": "application/pdf"
              }
            ]
          },
          "caption": {
            "type": "object",
            "description": "Subtitle files for audiovisual content",
            "example": [
              {
                "type": "MediaObject",
                "contentUrl": "https://example.org/captions/en.vtt",
                "inLanguage": "en"
              }
            ]
          }
        }
      },
      "FileMetadataExtensionsSchema": {
        "type": "object",
        "properties": {
          "fileDim": {
            "type": "object",
            "description": "Dimensions of the file (e.g., for images or videos)",
            "example": "1920x1080",
            "nullable": true
          },
          "fileAlt": {
            "type": "object",
            "description": "Alternative text for accessibility",
            "example": "A diagram showing TypeScript type system",
            "nullable": true
          }
        }
      },
      "ImageUrlsSchema": {
        "type": "object",
        "properties": {
          "high": {
            "type": "string",
            "description": "High resolution image URL (original size with optimization)",
            "example": "http://localhost:8080/rs:fit:0:0/plain/https%3A%2F%2Fexample.org%2Fimage.jpg"
          },
          "medium": {
            "type": "string",
            "description": "Medium thumbnail URL (approximately 400px width)",
            "example": "http://localhost:8080/rs:fit:400:0/plain/https%3A%2F%2Fexample.org%2Fimage.jpg"
          },
          "small": {
            "type": "string",
            "description": "Small thumbnail URL (approximately 200px width)",
            "example": "http://localhost:8080/rs:fit:200:0/plain/https%3A%2F%2Fexample.org%2Fimage.jpg"
          }
        },
        "required": [
          "high",
          "medium",
          "small"
        ]
      },
      "SystemExtensionsSchema": {
        "type": "object",
        "properties": {
          "source": {
            "type": "string",
            "description": "Data source identifier (e.g., \"nostr\" for Nostr database, \"arasaac\" for ARASAAC adapter)",
            "example": "nostr"
          },
          "foreignLandingUrl": {
            "type": "object",
            "description": "URL to the resource landing page on the original source website (e.g., Openverse, Flickr)",
            "example": "https://www.flickr.com/photos/12345/67890",
            "nullable": true
          },
          "attribution": {
            "type": "object",
            "description": "Attribution/copyright notice for the resource (e.g., for external sources)",
            "example": "Pictographic symbols are the property of the Government of Aragón",
            "nullable": true
          }
        },
        "required": [
          "source"
        ]
      },
      "ExtensionsSchema": {
        "type": "object",
        "properties": {
          "fileMetadata": {
            "description": "File metadata (dimensions and alt text) not covered by AMB standard",
            "nullable": true,
            "allOf": [
              {
                "$ref": "#/components/schemas/FileMetadataExtensionsSchema"
              }
            ]
          },
          "images": {
            "description": "Image proxy URLs for optimized image loading. Contains high, medium, and small thumbnail variants. Generated by server for security (signed URLs).",
            "nullable": true,
            "allOf": [
              {
                "$ref": "#/components/schemas/ImageUrlsSchema"
              }
            ]
          },
          "system": {
            "description": "System metadata (source, landing URL, attribution). Note: Creators are in amb.creator per AMB standard.",
            "allOf": [
              {
                "$ref": "#/components/schemas/SystemExtensionsSchema"
              }
            ]
          }
        },
        "required": [
          "system"
        ]
      },
      "OerItemSchema": {
        "type": "object",
        "properties": {
          "amb": {
            "description": "AMB (Allgemeines Metadatenprofil für Bildungsressourcen) metadata. Standards-compliant educational resource metadata.",
            "example": {
              "type": "LearningResource",
              "name": "Introduction to TypeScript",
              "description": "A comprehensive guide to learning TypeScript for beginners",
              "keywords": [
                "typescript",
                "programming",
                "tutorial"
              ],
              "inLanguage": [
                "en"
              ],
              "license": {
                "id": "https://creativecommons.org/licenses/by/4.0/"
              },
              "isAccessibleForFree": true,
              "learningResourceType": {
                "id": "https://w3id.org/kim/hcrt/tutorial"
              },
              "educationalLevel": {
                "id": "https://w3id.org/kim/educationalLevel/level_06"
              }
            },
            "allOf": [
              {
                "$ref": "#/components/schemas/AmbMetadataSchema"
              }
            ]
          },
          "extensions": {
            "description": "Extensions namespace for non-AMB metadata including Nostr-specific fields, image URLs, and system metadata",
            "allOf": [
              {
                "$ref": "#/components/schemas/ExtensionsSchema"
              }
            ]
          }
        },
        "required": [
          "amb",
          "extensions"
        ]
      },
      "OerMetadataSchema": {
        "type": "object",
        "properties": {
          "total": {
            "type": "number",
            "description": "Total number of resources matching the query",
            "example": 150
          },
          "page": {
            "type": "number",
            "description": "Current page number",
            "example": 1
          },
          "pageSize": {
            "type": "number",
            "description": "Number of items per page",
            "example": 20
          },
          "totalPages": {
            "type": "number",
            "description": "Total number of pages",
            "example": 8
          }
        },
        "required": [
          "total",
          "page",
          "pageSize",
          "totalPages"
        ]
      },
      "OerListResponseSchema": {
        "type": "object",
        "properties": {
          "data": {
            "description": "Array of Open Educational Resources",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/OerItemSchema"
            }
          },
          "meta": {
            "description": "Pagination metadata",
            "allOf": [
              {
                "$ref": "#/components/schemas/OerMetadataSchema"
              }
            ]
          }
        },
        "required": [
          "data",
          "meta"
        ]
      }
    }
  }
}